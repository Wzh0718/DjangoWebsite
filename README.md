# DjangoWebsite
## 项目描述
伴随着疫情爆发以后，人们越来越重视个人理财。股票作为当今热门的投资 理财方式之一，其具备的高风险、高回报率，始终得到人们的青睐。但是，由于 股票市场的日波动较大，股票价格变幻莫测。对于金融从业人员或研究人员而言， 可以利用机器学习的相关模型，对股票进行预测分析。其中，颇受欢迎的预测点 为股票的收盘价。而对于普通人群而言，使用机器学习需要学习相关编程和理论 等知识，不符合普通人群的直接使用需求。同时，现有股票预测模型只能针对某 一支股票，不符合普通人群持有多支股票的需求。
对此，本团队通过建立一个 Web 网站，将股票预测模型融入其中，使得普通 人群不用学习机器学习相关知识，也可以进行股票收盘价预测。其中，采用了广 泛运用在金融预测行业的 LSTM 模型，并通过 Python 相关库和代码优化，使其能 够进行数据获取、模型存在判断、模型训练、模型构建、模型调优、模型预测的 全自动化操作。同时，采用了 Python Web 中具有 MTV 框架的 Django Web，并结 合 Echart、Sweetalert2 开源组件，实现用户的注册、账号激活、密码修改、登 录和主页的用户行为记录、股票预测、可视化图标等操作，并优化网站的整体体 验。
最后，使用者只需要注册用户，便可以直接回到登录页面，避免重复性操作。 同时，在登录之后，借助通过登录的账号信息，从服务端 Mysql 数据库中获取用 户上一次进行股票预测的股票号，并返回该股票的长期趋势 k 线图和股票模型拟 合度图到主页，有助于用户直接参考该股票的趋势和加强对本项目的信息。用户 在主页可以通过键入对应的股票号，直观明了获得对应的预测值信息，可视化图 表也产生变化。用户可以点击预测值信息，获得对应股票预测模型的误差率，保 证了模型有据可参考。
## 项目主要功能
  该系统主要分为股票预测模型、Web 构建两个技术方向。对于股票 预测模型，采用在金融界广受好评的 LSTM 预测模型。在此基础上，将模 型的相关手动操作改良为自动化操作。对于 Web 构建，则采用具备完整网站配置 的 Django Web 框架，避免框架漏洞。并在此基础上利用 Django 的视图模块，隐 式实现调用爬虫接口、股票预测接口的操作，使用户的操作简易化。
在众多深度神经网络模型中，LSTM 模型被广泛应用于各种时间序列分析任 务中[3]。同时，对比其他预测模型，LSTM 模型在金融市场预测中有较高的权 威[4]。因此，本项目采用 LSTM 时序模型。

<img width="338" alt="image" src="https://user-images.githubusercontent.com/61780819/178501780-069508a9-cb51-49c0-818e-4ed2e70f6eb0.png">

### 模型构建
在构建 LSTM 模型的过程中，需要得到相关的数据进行训练和测试。因此， 通过 Python Request 库与 Pandas 库，将所需要的股票数据爬取、去异常值和 空值后写入到 Mysql 库中，提供给模型使用。通过分析影响股票市场的因素，考虑到股票运作过程中的人为主观因素。其会造成预测股票当日最高价、最低价的异常行为，使预测的误差率较大，导致预测不准确，无法使普通人群信服预测值。参考现有股票预测模型同大量他人的专业性论文，并结合股票相关知识，决定将当日股票的收盘价作为预测值。
结合本项目不只是单独构建某一支股票模型，在构建模型前添加判断语 句，以保证模型存在时不会重复训练。并且，在训练得到最优化模型之后直接 调用 Mysql 中对应的数据，进行预测，降低时间成本。

### Web 构建
对于客户而言，只需要简单的键入就可以获得对应的股票预测，且不需要 下载软件。对此，可以借助 Web 构建交互界面。同时，一个 Web 页面需要一个 完整的网站进行保护。在符合 Http/Https 安全协议下，Python Web 中的 Django 框架满足本系统所有需求[5]。因此，采用 Django 框架进行项目可视化
开发。

<img width="406" alt="image" src="https://user-images.githubusercontent.com/61780819/178501835-a6fcb2f9-a50d-4a81-91e3-4678a47fd043.png">

同时，为精简用户操作，将股票预测模型、获取数据源以 Python Api 接口 的方式被使用。通过用户提交一个包含股票号的 POST 命令，在 Django 视图模块中进行分析，并调用相关接口得到结果。将结果通过 Django 自带的重定向组 件，返回到 Web 页面当中。
结合 Js 中 Echart 开源组件轻便的特征，将相关接口返回的非预测明日的 收盘价数据进行可视化模块展示，分别为股票长期趋势图和模型拟合度展示 图。其中。模型拟合度展示图可以增强用户的信心，而股票长期趋势图便于协 助使用者进行参考。
结合 Django Auth 模块，优化可视化模块。当用户第一次登录时，直接获 取 Mysql 数据库中所记录的上一次股票信息，以避免可视化不存在的情况。当 用户进行预测后，可视化模块会更换为对应的股票信息。

## 环境要求
-	Python版本：推荐在3.8以上
- Tensorflow 版本：推荐在2.4.0以上
- Django版本：推荐3.2.12
- Pycharm版本：使用专业版
- Mysql版本：最新版即可

##安装过程及操作办法
解压本项目压缩包，通过Pycharm专业版打开本项目，通过Pycharm下载、导入对应的Python包。在终端通过cd命令到达项目文件路径下，执行python manage.py makemigrations和migrate命令，将模型映射到团队服务器Mysql数据库中。同时鉴于本团队服务器在2022年11月份后到期，建议使用者在本项目中找到Setting.py文件，修改里面的Database相关信息。最后，运行python manage.py runserver默认启动80端口。在Pycharm软件的运行界面下，得到对应URL连接，点击，即可使用本项目。
通过URL，登录到本项目之后，需要进行账号注册，同时不能直接通过Mysql数据库进行注册账号，会造成账号未激活的权限问题。登录账号之后，通常首页是不会出现长期趋势、同模型拟合度可视化图。对此，首次使用时建议直接键入股票号进行提交、预测，此过程会经历模型训练、调优、测试、预测。等待网站响应后，功能全部显示。
## 项目展示
本团队通过随机抽样的方式，选定股票号为000333、601857、300435、000671进行模型预测，得到最大预测误差为5.61%，最低误差为2.26%的测试结果（见图）。

<img width="254" alt="image" src="https://user-images.githubusercontent.com/61780819/178502385-192fb3b8-dc46-4bea-a322-d2a167dda64c.png">

图中首个数字代表误差率，最后一个数字代表股票号。

同时，通过模型拟合情况图可以认为，预测误差低于10%，且拟合状况良好，准确性较优，可以认为具有有效性。
 
 <img width="278" alt="image" src="https://user-images.githubusercontent.com/61780819/178502402-e1809cf5-8add-425e-b9d7-f1c3ae39ddb4.png">
模型以601857石油股票为例：

## 项目图示

<img width="1168" alt="image" src="https://user-images.githubusercontent.com/61780819/178503642-23028bd3-6a7e-4844-8c96-39ac3298db4e.png">


<img width="1278" alt="image" src="https://user-images.githubusercontent.com/61780819/178503311-320bcd0c-2c9a-4491-a223-c687e9dc37b2.png">


## 参考文献
[1] GRANGER C W J. The random character of stock market prices[J]. Journal of the American Statistical Association, 1965, 128(3): 447-449.

[2] 黄建华,钟敏,胡庆春.基于改进粒子群算法的LSTM股票预测模型[J/OL].华东理工大学学报(自然科学版):1-12[2022-04-05].DOI:10.14135/j.cnki.1006-3080.20210616001.

[3] KIM H Y, WON C H. Forecasting the volatility of stock price index: A hybrid model integrating LSTM with mul- tiple GARCH-Type models[J]. Expert Systems with Ap- plications, 2018, 103: 25-37.

[4] XIONG YC, ZHAO H. Chaotic time series prediction based on long short-term memory neural networks[J]. Scientia Sinica(Physica, Mechanica & Astronomica), 2019, 49(12): 120501.

[5] 邱红丽,张舒雅.基于Django框架的web项目开发研究[J].科学技术创新,2021(27):97-98.


